<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Data Analysis Studio</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <header>
      <h1>Data Analysis Studio</h1>
      <div id="app-info"></div>
      <nav>
        <a href="/docs" target="_blank">OpenAPI Docs</a>
        <a href="/redoc" target="_blank">ReDoc</a>
      </nav>
    </header>

    <main>
      <datalist id="dataset-ids"></datalist>
      <datalist id="columns-suggest"></datalist>

      <section class="card">
        <h2>1) CSV 업로드</h2>
        <form id="upload-form">
          <label>Dataset ID(선택): <input type="text" id="dataset-id" placeholder="자동 생성" /></label>
          <label>CSV 파일: <input type="file" id="csv-file" accept=".csv,text/csv" required /></label>
          <button type="submit">업로드</button>
        </form>
        <div id="upload-result" class="muted"></div>
      </section>

      <section class="card">
        <h2>2) 데이터셋 목록</h2>
        <div class="toolbar">
          <button id="refresh-list">새로고침</button>
        </div>
        <div id="datasets-list"></div>
      </section>

      <section class="card">
        <h2>3) 미리보기</h2>
        <form id="preview-form">
          <label>Dataset ID: <input type="text" id="preview-id" list="dataset-ids" required /></label>
          <label>행 수: <input type="number" id="preview-n" value="20" min="1" max="1000" /></label>
          <button type="submit">미리보기</button>
        </form>
        <div id="preview-table"></div>
      </section>

      <section class="card">
        <h2>4) 요약 통계</h2>
        <form id="describe-form">
          <label>Dataset ID: <input type="text" id="describe-id" list="dataset-ids" required /></label>
          <label>샘플 행 제한: <input type="number" id="describe-limit" value="5000" min="10" max="200000" /></label>
          <label>전체 컬럼 포함: <input type="checkbox" id="describe-all" checked /></label>
          <button type="submit">요약 보기</button>
        </form>
        <div id="describe-table"></div>
      </section>

      <section class="card">
        <h2>5) 결측치 현황</h2>
        <form id="nulls-form">
          <label>Dataset ID: <input type="text" id="nulls-id" list="dataset-ids" required /></label>
          <label>행 제한(옵션): <input type="number" id="nulls-limit" placeholder="전체" min="1" /></label>
          <button type="submit">결측치 보기</button>
        </form>
        <div id="nulls-table"></div>
      </section>

      <section class="card">
        <h2>6) 타입 변환</h2>
        <form id="cast-form">
          <label>Source ID: <input type="text" id="cast-source" list="dataset-ids" required /></label>
          <label>Column: <input type="text" id="cast-column" list="columns-suggest" required /></label>
          <label>Target Type:
            <select id="cast-type">
              <option value="int">int</option>
              <option value="float">float</option>
              <option value="string">string</option>
              <option value="datetime">datetime</option>
              <option value="bool">bool</option>
              <option value="category">category</option>
            </select>
          </label>
          <label>Out ID(옵션): <input type="text" id="cast-out" placeholder="자동 생성" /></label>
          <label><input type="checkbox" id="cast-strict" /> strict 모드(변환 실패 시 에러)</label>
          <button type="submit">변환 실행</button>
        </form>
        <div id="cast-result" class="muted"></div>
      </section>

      <section class="card">
        <h2>7) 분포(Distribution)</h2>
        <form id="dist-form">
          <label>Dataset ID: <input type="text" id="dist-id" list="dataset-ids" required /></label>
          <label>Column: <input type="text" id="dist-col" list="columns-suggest" required /></label>
          <label>Bins(숫자형): <input type="number" id="dist-bins" value="20" min="1" max="200" /></label>
          <label>TopK(문자형): <input type="number" id="dist-topk" value="20" min="1" max="200" /></label>
          <label><input type="checkbox" id="dist-dropna" checked /> 결측치 제외</label>
          <button type="submit">분포 계산</button>
        </form>
        <div id="dist-chart" class="chart"></div>
        <div id="dist-view"></div>
      </section>

      <section class="card">
        <h2>8) 상관관계(Correlation)</h2>
        <form id="corr-form">
          <label>Dataset ID: <input type="text" id="corr-id" list="dataset-ids" required /></label>
          <label>Method:
            <select id="corr-method">
              <option value="pearson" selected>pearson</option>
              <option value="spearman">spearman</option>
              <option value="kendall">kendall</option>
            </select>
          </label>
          <label>행 제한: <input type="number" id="corr-limit" value="50000" min="100" /></label>
          <button type="submit">상관분석</button>
        </form>
        <div id="corr-chart" class="chart"></div>
        <div id="corr-view"></div>
      </section>

      <section class="card">
        <h2>9) 샘플/필터 다운로드</h2>
        <form id="sample-form">
          <label>Dataset ID: <input type="text" id="sample-id" list="dataset-ids" required /></label>
          <label>Rows: <input type="number" id="sample-rows" value="100" min="1" max="100000" /></label>
          <button type="submit">샘플 CSV 다운로드</button>
        </form>
        <hr />
        <form id="filter-form">
          <label>Dataset ID: <input type="text" id="filter-id" list="dataset-ids" required /></label>
          <label>Columns(쉼표): <input type="text" id="filter-cols" placeholder="예: col1,col2" /></label>
          <label>Limit: <input type="number" id="filter-limit" value="10000" min="0" max="500000" /></label>
          <label>Query: <input type="text" id="filter-query" placeholder="예: price > 10 and category == 'A'" /></label>
          <button type="submit">필터 CSV 다운로드</button>
        </form>
        <div class="muted">주의: Query는 pandas query 문법을 사용합니다.</div>
      </section>

      <section class="card">
        <h2>10) 기초 전처리</h2>
        <h3>결측치 채우기 (fillna)</h3>
        <form id="fillna-form">
          <label>Source ID: <input type="text" id="fillna-source" list="dataset-ids" required /></label>
          <label>Columns(옵션, 쉼표): <input type="text" id="fillna-cols" placeholder="미지정 시 전체" /></label>
          <label>Strategy:
            <select id="fillna-strategy">
              <option value="value" selected>value</option>
              <option value="mean">mean</option>
              <option value="median">median</option>
              <option value="mode">mode</option>
            </select>
          </label>
          <label>Value(Strategy=value일 때): <input type="text" id="fillna-value" placeholder="예: 0 또는 'N/A'" /></label>
          <label>Out ID(옵션): <input type="text" id="fillna-out" placeholder="자동 생성" /></label>
          <button type="submit">실행</button>
        </form>
        <div id="fillna-result" class="muted"></div>

        <h3>컬럼 삭제 (drop)</h3>
        <form id="drop-form">
          <label>Source ID: <input type="text" id="drop-source" list="dataset-ids" required /></label>
          <label>Columns(쉼표): <input type="text" id="drop-cols" required placeholder="예: col1,col2" /></label>
          <label>Out ID(옵션): <input type="text" id="drop-out" placeholder="자동 생성" /></label>
          <button type="submit">실행</button>
        </form>
        <div id="drop-result" class="muted"></div>

        <h3>컬럼 이름 변경 (rename)</h3>
        <form id="rename-form">
          <label>Source ID: <input type="text" id="rename-source" list="dataset-ids" required /></label>
          <label>Mapping(쉼표, 콜론): <input type="text" id="rename-mapping" placeholder="old1:new1,old2:new2" required /></label>
          <label>Out ID(옵션): <input type="text" id="rename-out" placeholder="자동 생성" /></label>
          <button type="submit">실행</button>
        </form>
        <div id="rename-result" class="muted"></div>
      </section>
    </main>

    <footer>
      <span class="muted">UI는 단순 데모용입니다. 대용량 처리/보안은 서버에서 관리됩니다.</span>
    </footer>

    <script src="./app.js"></script>
    <script src="./suggest.js"></script>
  </body>
  </html>
